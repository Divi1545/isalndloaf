# IslandLoaf Airtable Integration Schema

## Current Tables (Provided by User)

### 1. Vendors
```csv
Vendor ID,Name,Category,Instagram,Commission Rate,Location
V001,Ella Retreat,Hotel,@ellaretreat,15%,Ella
V002,Beach Safari,Tour,@beachsafari,10%,Mirissa
```

### 2. Bookings
```csv
Booking ID,Vendor ID,Customer Name,Email,Guests,Check-in,Check-out,Status
B001,V001,Alice Fernando,alice@example.com,2,2025-07-01,2025-07-05,Confirmed
B002,V002,Danushka Silva,danushka@example.com,4,2025-07-10,2025-07-12,Pending
```

### 3. Payments
```csv
Payment ID,Booking ID,Vendor ID,Amount,Status,Due Date
P001,B001,V001,50000,Paid,2025-07-05
P002,B002,V002,70000,Pending,2025-07-12
```

### 4. Daily Reports
```csv
Report Date,Total Bookings,Total Revenue,New Vendors,Cancelled Bookings
2025-07-01,2,120000,1,0
2025-07-02,3,180000,0,1
```

## Recommended Additional Tables

### 5. Services (Product Catalog)
```csv
Service ID,Vendor ID,Name,Category,Description,Base Price,Max Guests,Available
S001,V001,Standard Room,Accommodation,Comfortable room with mountain view,25000,2,Yes
S002,V002,Whale Watching,Tour,3-hour whale watching boat tour,15000,8,Yes
S003,V001,Deluxe Suite,Accommodation,Luxury suite with private balcony,45000,4,Yes
```

### 6. Customer Feedback
```csv
Feedback ID,Booking ID,Customer Name,Rating,Review,Sentiment,Date
F001,B001,Alice Fernando,5,Amazing place with great hospitality,Positive,2025-07-06
F002,B002,Danushka Silva,4,Good tour but could be longer,Positive,2025-07-13
```

### 7. Marketing Campaigns
```csv
Campaign ID,Vendor ID,Platform,Content Type,Title,Status,Scheduled Date,Performance
C001,V001,Instagram,Post,Ella Mountain Retreat Special,Published,2025-07-01,High
C002,V002,Facebook,Story,Whale Season Started,Scheduled,2025-07-15,Pending
```

### 8. Agent Training (For AI Optimization)
```csv
Training ID,Agent Type,Input Example,Expected Output,Context,Status,Date
T001,Booking,Create booking for 2 guests,Booking B003 created successfully,Standard accommodation booking,Processed,2025-07-01
T002,Vendor,Analyze vendor V001,Vendor performance: 95% satisfaction rate,Monthly vendor review,Processed,2025-07-02
```

### 9. System Logs
```csv
Log ID,Timestamp,Event Type,Agent,Action,Data,Status,Response Time
L001,2025-07-01 10:30:00,Agent Execution,booking,create,{booking_data},Success,150ms
L002,2025-07-01 10:31:00,Webhook,n8n,vendor_onboarding,{vendor_data},Success,89ms
```

### 10. Calendar Events
```csv
Event ID,Vendor ID,Service ID,Start Date,End Date,Event Type,Status,Source
E001,V001,S001,2025-07-01,2025-07-05,Booking,Confirmed,Direct
E002,V001,S001,2025-07-06,2025-07-08,Blocked,Active,Manual
```

## API Integration Points

### Agent Executor Integration
```javascript
// POST /api/agent/execute
{
  "agent": "booking",
  "action": "create",
  "data": {
    "vendorId": "V001",
    "serviceId": "S001", 
    "customerName": "Alice Fernando",
    "customerEmail": "alice@example.com",
    "checkIn": "2025-07-01",
    "checkOut": "2025-07-05",
    "guests": 2
  }
}
```

### Webhook Integration
```javascript
// POST /api/webhooks/n8n
{
  "workflow": "booking_automation",
  "data": {
    "vendorId": "V001",
    "serviceId": "S001",
    "customerName": "Alice Fernando",
    "customerEmail": "alice@example.com",
    "totalPrice": 50000
  },
  "executionId": "exec-12345"
}
```

### AI Features Integration
All AI endpoints (`/api/ai/*`) can log results to Airtable:
- Booking optimization recommendations
- Vendor analytics insights  
- Customer feedback analysis
- Marketing content generation
- Trip concierge suggestions

## Environment Variables Needed

```env
# Airtable Configuration
AIRTABLE_API_KEY=keyXXXXXXXXXXXXXX
AIRTABLE_BASE_ID=appXXXXXXXXXXXXXX

# Agent API (for external access)
AGENT_API_KEY=your-secure-agent-api-key

# Webhook Security
N8N_WEBHOOK_SECRET=your-n8n-webhook-secret
```

## Current System Compatibility

Your current tables perfectly match the IslandLoaf data structure:

- **Vendors** → Maps to User model (role: vendor)
- **Bookings** → Maps to Booking model 
- **Payments** → Can integrate with Stripe webhooks
- **Daily Reports** → Generated by analytics endpoints

The system can immediately start using your Airtable data with minimal configuration changes.